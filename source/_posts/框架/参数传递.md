---
title: 参数传递
date: 2023-09-19 17:17:55
tags:
description:
categories:
---


# 解决跨域

> 参考 https://spring.io/blog/2015/06/08/cors-support-in-spring-framework

## `@CrossOrigin`配置方法或者控制器

```java

@CrossOrigin(origins = "http://domain2.com", maxAge = 3600)@RestController
@RequestMapping("/account")
public class AccountController {

	//@CrossOrigin
	@GetMapping("/{id}")
	public Account retrieve(@PathVariable Long id) {
		// ...
	}

	@DeleteMapping("/{id}")
	public void remove(@PathVariable Long id) {
		// ...
	}
}
```



## 全局配置

```java
@Configuration
public class MyConfiguration {

    @Bean
    public WebMvcConfigurer corsConfigurer() {
        returnlic WebMvcConfiguapter() {
            @Override
            public void addCorsMappings(CorsRegistry registry) {
                registry.addMapping("/**");
            }
        };
    }
}
```

## 通过拦截器配置跨域

```java
@Configuration
public class MyConfiguration {
    @Bean
    //通过过滤器的方式增加跨域
    public FilterRegistrationBean corsFilter() {
        UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();
        CorsConfiguration config = new CorsConfiguration();
        config.setAllowCredentials(true);
        config.addAllowedOrigin("http://localhost:63342");
        config.addAllowedHeader("*");
        config.addAllowedMethod("*");
        source.registerCorsConfiguration("/**", config);
        FilterRegistrationBean bean = new FilterRegistrationBean(new CorsFilter(source));
        bean.setOrder(0);
        return bean;
    }
}
```





# 传递参数

## 使用`@Pathvariable`

```java
    @RequestMapping("/{name}/{id}")
    public String pathVariableTest(@PathVariable("id") Integer id2, 
                                   @PathVariable String name) {
        return name + "====" + id2;
    } }
```

建议：参数名称保持一致，可以不用指定，被修饰的参数必须传递

```js
    let apiUrl = "http://localhost:8080/param/";
    let name = "张三";
    let id = 11;
    let params = {
        "name":name,
        "id":id
    }
    function pathVariableTest() {
        $.ajax({
            url: apiUrl + name + "/" + id,
            success: function (data) {
                alert(data)
            }
        })
    }
```

## 使用`@RequestParam`

```java
    @RequestMapping("/requestParamTest")
    public String requestParamTest(@RequestParam("name") String name, Integer id) {
        System.out.println(name + "====" + id);
        return name + "====" + id;
    }
```

`@RequestParam`修饰的必须传递

不带修饰的Integer类型id，可以不传，但是如果是int id，不传会报错

即：Integer可以接受null类型的，int不行

> Optional int parameter 'id' is present but cannot be translated into a null value due to being declared as a primitive type. Consider declaring it as object wrapper for the corresponding primitive type.

```js
    function requestParamTest() {
        $.ajax({
            url: apiUrl+"requestParamTest",
            data:params,
            success: function (data) {
                alert(data)
            }
        })
    }
```

## `@RequestBody`

### `@RequestBody`+Entity

```java
    @RequestMapping("/requestBodyTest")
    public String requestBodyTest(@RequestBody User user){
        System.out.println(user.toString());
        return user.toString();
    }
```

js代码如下：

>   type:"post",
>   data:JSON.stringify(params),
>   contentType:"application/json;",

```js
    function requestBodyTest() {
        $.ajax({
            url: apiUrl+"requestBodyTest",
            type:"post",
            data:JSON.stringify(params),
            contentType:"application/json;",
            success: function (data) {
                alert(data)
            }
        })
    }
```

### `@RequestBody`+Map/JSONObject/String

```xml
        <dependency>
            <groupId>com.alibaba</groupId>
            <artifactId>fastjson</artifactId>
            <version>2.0.32</version>
        </dependency>
```

添加依赖

```java
    @RequestMapping("/bodyMapTest")
    public String bodyMapTest(@RequestBody Map<String, Object> map) {
        System.out.println(map.get("name"));
        System.out.println(map.get("id"));
        return map.toString();
    }

    @RequestMapping("/bodyStringTest")
    public String bodyStringTest(@RequestBody String jsonString) {
        JSONObject jsonObject = JSONObject.parseObject(jsonString);
        String name = jsonObject.getString("name");
        Integer age = jsonObject.getInteger("id");
        return name + "=====" + age;
    }

    @RequestMapping("/bodyJSONObjectTest")
    public String bodyJSONObjectTest(@RequestBody JSONObject jsonObject) {
        System.out.println(jsonObject.getString("name"));
        System.out.println(jsonObject.getInteger("id"));
        return jsonObject.toString();
    }
```

js代码同上

## Entity

```java
    @RequestMapping("/entityTest")
    public String entityTest(User user) {
        System.out.println(user.toString());
        return user.toString();
    }
```

js代码：去掉contentype，data使用参数形式

```js
    function entityTest() {
        $.ajax({
            // url: apiUrl+"entityTest",
            // url: apiUrl+"requestHeaderTest",
            url: apiUrl+"httpServletRequestTest",
            type:"post",
            data:params,
            headers:{
                "token":"token123"
            },
            // contentType:"application/json;",
            success: function (data) {
                alert(data)
            }
        })
    }
```

每个参数都可以不传，当不传时，

如果是包装类型，则默认值是null,如果是基本类型时，默认值如下

| 基本      | 包装        | 默认值           |
|:-------:|:---------:|:-------------:|
| byte    | Byte      | (byte)0       |
| short   | short     | (short)0      |
| int     | Interger  | 0             |
| long    | Long      | 0L            |
| double  | Double    | 0.0d          |
| float   | Float     | 0.0f          |
| char    | Character | '\u0000'(NUL) |
| boolean | Boolean   | false         |

## `@RequestHeader`

```js
            headers:{
                "token":"token123"
            },
```

> @RequestHeader String token

获取header中的参数

## HttpServletRequest

```java
    public String httpServletRequestTest(HttpServletRequest request) {
        System.out.println(request.getHeader("token"));
        System.out.println(request.getParameter("name"));
        return request.getRequestId();
    }
```





# 参数校验

@Valid：java自带的校验：不支持分组，支持嵌套校验

@Validated：spring扩展：支持分组，不支持嵌套校验



# ApiPost的使用

> https://blog.csdn.net/qq_35387940/article/details/124387807




